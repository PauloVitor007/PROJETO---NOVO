{% extends 'base.html' %}
{% block title %}{{ clube.nome }} - Hub Comunitário{% endblock %}

{% block content %}
<div class="back-link-container">
    <a href="{{ url_for('clubes') }}">&larr; Voltar para a lista de clubes</a>
</div>

<div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
        <div>
            <h2>{{ clube.nome }}</h2>
            <span class="vagas-badge-lg" style="font-size: 1rem;"><i class="fas fa-tag"></i> {{ clube.categoria }}</span>
        </div>
        <div>
            {% if is_member %}
                {% if not is_leader %}
                <form action="{{ url_for('leave_club', clube_id=clube.id) }}" method="POST" style="display: inline;">
                    <button type="submit" class="btn btn-secondary"><i class="fas fa-sign-out-alt"></i> Sair do Clube</button>
                </form>
                {% endif %}
            {% else %}
                 <form action="{{ url_for('join_club', clube_id=clube.id) }}" method="POST" style="display: inline;">
                    <button type="submit" class="btn"><i class="fas fa-user-plus"></i> Entrar no Clube</button>
                </form>
            {% endif %}
        </div>
    </div>
    <div class="card-body">
        <p class="lead">{{ clube.descricao }}</p>
        <p><strong>Líder:</strong> {{ clube.lider.username if clube.lider else 'Não definido' }}</p>
        <p><strong>Membros:</strong> {{ clube.membros.count() }}</p>
    </div>
    {% if is_member %}
    <div class="card-footer" style="display: flex; gap: 10px; flex-wrap: wrap;">
        <strong>Ações do Clube:</strong>
        <a href="{{ url_for('clube_forum', clube_id=clube.id) }}" class="btn btn-sm"><i class="fas fa-comments"></i> Fórum</a>
        <a href="{{ url_for('clube_media', clube_id=clube.id) }}" class="btn btn-sm"><i class="fas fa-photo-video"></i> Galeria</a>
        {% if is_leader %}
            <a href="{{ url_for('criar_evento_clube', clube_id=clube.id) }}" class="btn btn-sm btn-success"><i class="fas fa-plus"></i> Criar Evento</a>
        {% endif %}
    </div>
    {% endif %}
</div>

<h3 class="page-header" style="margin-top: 2rem;">Próximos Eventos do Clube</h3>
{% if eventos_futuros %}
    <div class="course-grid">
    {% for evento in eventos_futuros %}
        {% include 'partials/evento_card.html' %}
    {% endfor %}
    </div>
{% else %}
    <div class="card empty-state">
        <p class="text-muted">Este clube não tem eventos futuros agendados.</p>
    </div>
{% endif %}

<h3 class="page-header" style="margin-top: 2rem;">Eventos Passados</h3>
{% if eventos_passados %}
    <ul class="simple-list">
    {% for evento in eventos_passados %}
        <li><a href="{{ url_for('detalhe_evento', evento_id=evento.id) }}">{{ evento.titulo }}</a> - <small>{{ evento.data_evento.strftime('%d/%m/%Y') }}</small></li>
    {% endfor %}
    </ul>
{% else %}
     <div class="card empty-state">
        <p class="text-muted">Nenhum evento passado registrado para este clube.</p>
    </div>
{% endif %}
{% endblock %}